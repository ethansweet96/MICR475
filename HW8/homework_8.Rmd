---
title: "Homework 8"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
str(diamonds)
library(nls2)
library(broom)

```
# Part 1
```{r}
#Must complete this section, not done. 
#ggplot(diamonds, aes(x = clarity,y = price))

```

# Part 2
```{r}



monod_mod <- formula(density ~ (conc*dmax)/(conc + k))

sqrt_mod <- formula(density ~ beta_1 * sqrt(conc) + beta_0)
single_sqrt_model <- nls2(sqrt_mod,
data = DNase,
start = list(beta_1 = 0.5, beta_0 = 0.1))

compare_models <- DNase %>%
  group_by(Run) %>%
  nest() %>%
  mutate(sqrt_mod = map(data, ~ nls2(
    sqrt_mod,
    data = .,
    start = list(beta_1 = 0.5, beta_0 = 0.1)
  )),
  monod_mod = map(data,  ~ nls2(
    monod_mod, data = ., start = list(dmax = .3, k = .4)
  )),
  sqrt_aic= map_dbl(sqrt_mod,~glance(.)$AIC),
  monod_aic=map_dbl(monod_mod,~glance(.)$AIC))

```

